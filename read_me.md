# 予約システム（Piste Reserve）仕様書

## 1. プロジェクト概要
本作は、パーソナルジム「Piste」の顧客が、スマートかつ直感的にセッションの予約・管理を行えるようにするためのWebアプリケーションです。
ターゲット層である20〜60代の方々にとって使いやすく、かつプレミアム感のあるデザインを目指します。

## 2. ターゲットユーザー
- **既存会員**: 日々のトレーニング予約、契約プランの管理を行う。
- **体験希望者**: 初回の無料体験・カウンセリングを予約する。
- **管理者**: 予約状況の確認、スケジュールの調整、顧客情報の管理を行う。

## 3. 主要機能一覧

### 3.1 ユーザー向け機能
- **予約カレンダー**:
  - **予約メニュー一覧**:
    - パーソナルトレーニング（20分）
    - 無料体験（60分）
    - 入会手続き（30分）
    - オンラインパーソナル（30分）
    - 初回パーソナル（60分）
  - **UI/UXフロー**:
    - **ステップ1**: カレンダーUIで希望の「日付」を選択。
    - **ステップ2**: 選択した日付に応じた「時間ごとの空き状況」をリスト表示。
    - **ステップ3**: 希望の時間枠を選択し、予約内容の確認へ。
  - リアルタイムでの空き状況表示。
  - **HP/LP連携機能**:
    - HPやLPからの予約ボタンに直リンクを設置可能。
    - URLパラメータによる予約種別の事前選択（例：体験予約URL、会員用予約URLなど）。
    - 外部サイトからのシームレスな遷移とデザインの親和性確保。
- **マイページ**:
  - 現在の予約一覧と履歴の確認。
  - 予約のキャンセル（期限内）。
  - 現在の契約プラン（月額定額制）のステータス確認。
- **決済・プラン契約**:
  - クレジットカード決済。
  - 月額定額プランの契約・管理。
- **通知機能**:
  - 予約完了通知、予約前日のリマインド。
- **AIコンシェルジュ (Web & LINE ハイブリッド)**:
  - **Web版AI（アプリ内搭載）**:
    - **無料・無制限対話**: LINEの通数制限を気にせず、ブラウザ上で自由に予約相談が可能。
    - **UI連動**: AIの回答に合わせてカレンダーがスクロールしたり、予約枠が強調されるリッチな体験。
  - **LINE版AI**:
    - **外出先からの操作**: LINE Messaging API（無料枠200通/月）を活用。
    - **プッシュ通知連携**: 予約リマインドからのスムーズな変更受付。
  - **共通エンジン**: Gemini API（無料枠）を活用し、自然言語での「空き確認」「新規予約」「変更・キャンセル」を全プラットフォームで実現。

### 3.2 管理者向け機能
- **ダッシュボード**:
  - 本日の予約一覧、直近の予約状況の可視化。
- **予約管理**:
  - 全ユーザーの予約確認、変更、キャンセル代行。
- **顧客管理 (CRM)**:
  - 顧客リスト、連絡先、利用履歴、現在のサブスクリプション状況。
- **スケジュール設定**:
  - **定休日設定**:
    - デフォルト：日曜日、月曜日、祝日。
    - 管理者画面から任意の曜日・特定の日付を休日（または営業日）として柔軟に切り替え可能。
  - 予約枠（コマ数）の柔軟な変更。
- **売上管理**:
  - 月次売上の確認、プラン加入状況のレポート。
- **Googleカレンダー双方向連携**:
  - **アプリ → Google**: アプリ経由の予約を即座にGoogleカレンダーへ反映。
  - **Google → アプリ**: Googleカレンダー上での操作（手動予約等）をアプリ側へ同期。
  - **プライバシー配慮同期**: 「石川」個人の予定をアプリ側へ自動反映。ただし、一般の予約画面では具体的な件名は伏せ、「予約不可」または「店主都合」等の表示に限定する。
- **Gmail連携**:
  - **自動送信**: 予約確定時、変更時、キャンセル時に管理者（石川様）のGmailアカウントからユーザーへ予約確認メールを自動送信。
- **AIエージェント連携 (AI Automation)**:
  - **自然言語による予約操作**: Antigravity等のAIエージェントからの指示（例：「2/3 18:00〜 石川様 予約追加」）を自動的にシステムへ反映。
  - **AIコマンドログ**: エージェントが行った操作履歴の確認と承認。
  - **アシスタント通知**: AIによるスケジュール重複の警告や、キャンセル発生時の自動枠開放提案。

## 4. 技術スタック（推奨）
- **Frontend**: Vite + React / TypeScript
- **Styling**: Vanilla CSS (Modern CSS properties)
- **Backend / DB**: Supabase (PostgreSQL, Auth, Database)
- **Payment**: Stripe (定期支払い、スポット決済)
- **Hosting / Server**: Netlify

## 5. デザイン方針
- **Mobile First**: スマートフォンでの操作性を最優先した設計（親指で操作しやすいボタン配置、スワイプ操作の活用など）。
- **Rich & Premium**: 落ち着いた配色（ダークブルー、ゴールド、ホワイト）を使用し、信頼感と高級感を演出。
- **High Accessibility**: 全世代（20〜60代）にとっての使いやすさを追求。文字サイズ、コントラスト、直感的なナビゲーションを確保。
- **Micro-animations**: 操作に対する心地よいフィードバック（ボタンクリック、画面遷移など）。

## 6. 今後のロードマップ
1. **フェーズ1**: 最小機能（予約・カレンダー・Google連携）＋ **Web版AIコンシェルジュ**の構築。
2. **フェーズ2**: **LINE AIアシスタント連携**（通知・モバイル操作）。
3. **フェーズ3**: 決済連携（Stripe）とサブスクリプション管理の実装。
4. **フェーズ4**: 複数トレーナー対応（担当トレーナー選択機能、複数人のスケジュール管理）。
